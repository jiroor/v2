# UIライブラリ検討

## 日付
2025-10-29

## 背景
現在、すべてのUIコンポーネントを独自に実装しているが、汎用的なUIパーツをライブラリに置き換えることで、開発効率と品質を向上させたい。ただし、**バンドルサイズ100KB未満**という制約があるため、軽量性を最優先に検討する必要がある。

## 調査した選択肢

### 1. shadcn/ui ⭐ **最有力候補**

#### 概要
- コピー&ペースト方式のコンポーネント集
- Radix UI + Tailwind CSS ベース
- npmパッケージではなく、ソースコードを直接プロジェクトにコピー

#### バンドルサイズ
- **実測値**: Material-UIと比較して **40-60%小さい**
- 使用するコンポーネントのみがバンドルに含まれる
- Tree-shakingが完璧に機能（使わないコードは一切含まれない）
- Tailwind CSSのPurgingで未使用CSSも除去

#### メリット
- ✅ **極めて軽量**: 必要なコンポーネントのみ追加
- ✅ **完全なカスタマイズ性**: ソースコードを所有
- ✅ **依存関係の最小化**: 巨大なライブラリをインストールしない
- ✅ **最適化の自由度**: 自分で`React.memo`などを適用可能
- ✅ **アクセシビリティ**: Radix UIベースでWCAG準拠
- ✅ **現代的なデザイン**: 2025年のトレンドに対応

#### デメリット
- ❌ Tailwind CSSの導入が必須（現在未使用）
- ❌ 各コンポーネントを個別にコピー&インストール
- ❌ アップデートは手動で反映

#### 導入コスト
- Tailwind CSS セットアップ: **中**
- コンポーネント移行: **高**（すべて書き直し）

#### 推定バンドルサイズ影響
- Tailwind CSS: 約10-20KB (gzip後)
- Radix UI (必要な部分のみ): 約5-15KB
- **合計**: 約15-35KB 増加（許容範囲内）

---

### 2. Radix UI (Primitives)

#### 概要
- ヘッドレス（スタイルなし）UIコンポーネント
- アクセシビリティに特化
- 個別にパッケージをインストール可能

#### バンドルサイズ
- **全コンポーネント**: 49KB
- **@radix-ui/themes**: 80KB
- **個別インストール**: 各コンポーネント数KB〜

#### メリット
- ✅ **軽量**: 個別インストールで最小化
- ✅ **アクセシビリティ完璧**: WCAG準拠
- ✅ **スタイルの自由度**: 完全に自分でスタイリング
- ✅ **Tree-shaking対応**: 使わない部分は含まれない

#### デメリット
- ❌ スタイルを全て自分で書く必要がある
- ❌ デザインシステムは含まれない
- ❌ 学習コストが高い

#### 導入コスト
- セットアップ: **低**
- コンポーネント移行: **高**（スタイリング含む）

#### 推定バンドルサイズ影響
- 必要なコンポーネントのみ: 約10-30KB

---

### 3. Headless UI

#### 概要
- Tailwind Labs製のヘッドレスUIライブラリ
- Tailwind CSSとの相性が良い
- コンポーネント数は少なめ

#### バンドルサイズ
- **具体的な数値不明**
- Radix UIより軽量とされる

#### メリット
- ✅ 軽量
- ✅ Tailwind CSSと親和性が高い
- ✅ シンプルなAPI

#### デメリット
- ❌ コンポーネント数が少ない
- ❌ Radix UIほどアクセシビリティに特化していない
- ❌ Tailwind CSS導入が必須

#### 導入コスト
- セットアップ: **中**（Tailwind必要）
- コンポーネント移行: **中**

#### 推定バンドルサイズ影響
- 約5-20KB

---

### 4. Chakra UI

#### 概要
- 軽量で使いやすいコンポーネントライブラリ
- コードスプリッティング対応
- モジュラー設計

#### バンドルサイズ
- **公称**: 軽量とされるが具体的な数値不明
- Tree-shaking対応

#### メリット
- ✅ 使いやすいAPI
- ✅ レスポンシブ対応
- ✅ アクセシビリティ対応

#### デメリット
- ❌ バンドルサイズがshadcn/uiより大きい可能性
- ❌ カスタマイズ性がshadcn/uiより低い

---

### 5. Mantine

#### 概要
- オールインワンのUIライブラリ
- 軽量とされるが包括的

#### バンドルサイズ
- **不明**（"軽量"とされるが具体的な数値なし）

#### メリット
- ✅ 包括的なコンポーネント
- ✅ 開発生産性が高い

#### デメリット
- ❌ オールインワンのため、必要ない機能も含まれる可能性
- ❌ バンドルサイズの制約に適合しない可能性

---

## 却下した選択肢

### Material-UI (MUI)
- ❌ **バンドルサイズが大きい**（本プロジェクトの制約に不適合）
- ❌ Tree-shakingが完璧でない
- ❌ ミニマルデザインの方針と合わない

### Ant Design
- ❌ バンドルサイズが大きい
- ❌ デザインが本プロジェクトと合わない

---

## 推奨: shadcn/ui

### 理由

1. **バンドルサイズ制約を満たす**
   - 40-60%小さいバンドルサイズ
   - 必要なコンポーネントのみ追加
   - 推定15-35KB増加（100KB制約内）

2. **アクセシビリティ**
   - Radix UIベース
   - WCAG 2.2準拠
   - キーボードナビゲーション完璧

3. **カスタマイズ性**
   - ソースコードを所有
   - ミニマルデザインに合わせて調整可能

4. **現代的**
   - 2025年のベストプラクティス
   - Tailwind CSS + Radix UIの組み合わせ

5. **長期メンテナンス**
   - コードを所有しているため、ライブラリの廃止リスクなし
   - 自分でメンテナンス可能

### 導入手順（概要）

1. **Tailwind CSSのセットアップ**
   ```bash
   npm install -D tailwindcss postcss autoprefixer
   npx tailwindcss init -p
   ```

2. **shadcn/ui CLIのインストール**
   ```bash
   npx shadcn@latest init
   ```

3. **必要なコンポーネントを追加**
   ```bash
   npx shadcn@latest add button
   npx shadcn@latest add input
   npx shadcn@latest add select
   # など
   ```

4. **既存コンポーネントを段階的に置き換え**

### 懸念点と対策

#### 懸念1: Tailwind CSSの導入
- **対策**: PostCSSでPurgeを適切に設定し、未使用のCSSを完全に削除
- **結果**: 最小限のCSS追加（10-20KB）

#### 懸念2: 既存コードの書き直し
- **対策**: 段階的な移行
  1. まず新規コンポーネントから
  2. 既存コンポーネントは徐々に置き換え
- **結果**: リスクを最小化

#### 懸念3: CSS Modulesとの共存
- **対策**: Tailwind CSSと CSS Modulesは共存可能
- **結果**: 徐々に移行できる

---

## 代替案: Radix UI + 独自スタイリング

Tailwind CSSの導入を避けたい場合：

### 方法
- Radix UI Primitivesのみ使用
- 既存のCSS Modulesでスタイリング

### メリット
- 既存のスタイリング方法を維持
- バンドルサイズ増加が最小（10-30KB）

### デメリット
- スタイリングを全て自分で書く必要
- shadcn/uiほど生産性が上がらない

---

## 結論

**shadcn/ui を推奨**

- バンドルサイズ制約を満たす
- アクセシビリティ完璧
- カスタマイズ性が高い
- 長期的に保守しやすい

ただし、Tailwind CSSの導入コストがあるため、**段階的な移行**を推奨。

### 移行ロードマップ案

1. **Phase 1: 調査・検証**（1-2日）
   - Tailwind CSS + shadcn/ui をブランチで試験導入
   - バンドルサイズを実測

2. **Phase 2: 新規コンポーネント**（1週間）
   - 新しく作るページはshadcn/uiを使用
   - 既存ページは維持

3. **Phase 3: 段階的移行**（2-3週間）
   - 優先度の高いページから置き換え
   - バンドルサイズを監視

4. **Phase 4: 完全移行**（1-2週間）
   - すべてのコンポーネントを移行
   - 最終的なバンドルサイズ最適化

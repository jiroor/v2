# テキスト差分表示

## 日付
2025-10-29

## 実装目的
2つのテキストを比較して、差分を視覚的に表示する。文書の変更箇所を確認したり、コードの差分をチェックする際に便利。

## 画面構成・UI
- 2つのテキストエリア（左右または上下配置）
  - 左/上：オリジナルテキスト
  - 右/下：比較テキスト
- 差分表示エリア
  - 追加された行：緑色でハイライト
  - 削除された行：赤色でハイライト
  - 変更なし：通常表示
- クリアボタン（両方のテキストをクリア）
- レスポンシブ対応：デスクトップは左右、モバイルは上下配置

## データ構造

### DiffResult型
```typescript
interface DiffLine {
  type: 'added' | 'removed' | 'unchanged'
  content: string
  originalLineNumber?: number
  newLineNumber?: number
}
```

### textDiffUtils関数
```typescript
function calculateDiff(original: string, modified: string): DiffLine[]
```

## 実装ファイル
- src/utils/textDiffUtils.ts - 差分計算ロジック
- src/pages/TextTools/TextDiff.tsx - UIコンポーネント
- src/pages/TextTools/TextDiff.module.css - スタイル
- src/App.tsx - ルーティング追加
- src/pages/Home.tsx - リンク有効化

## 技術的な設計判断

### 差分アルゴリズム
- **簡易実装**: 行単位の完全一致比較
  - 外部ライブラリを使わず、バンドルサイズを最小化
  - 行ごとに比較し、追加/削除/変更なしを判定
  - より高度な差分（単語単位、文字単位）は将来的に検討

### アルゴリズムの概要
1. 両方のテキストを行単位で分割
2. 各行を順番に比較
3. 簡易的なLCS（最長共通部分列）アプローチ
   - 一致する行は unchanged
   - 片方にしかない行は added/removed

### パフォーマンス考慮
- useMemoで差分計算結果をキャッシュ
- 大量のテキスト（1000行以上）では処理が遅くなる可能性
  - → Phase 1では警告のみ、最適化は後回し

### UI設計
- シンプルな色分け（緑=追加、赤=削除、白=変更なし）
- 行番号は表示しない（Phase 1では省略）
- 行ごとにブロック表示

## リスク・注意点
- 大量のテキストでパフォーマンスが低下する可能性
- 簡易的な差分アルゴリズムのため、複雑な変更の検出精度は限定的
- 外部ライブラリ（diff等）を使わないため、バンドルサイズは小さいが機能は基本的

## 完了条件
- [x] memories/features/にテキスト差分の設計を記録
- [ ] textDiffUtilsを実装
- [ ] TextDiffコンポーネントを実装
- [ ] App.tsxにルーティングを追加
- [ ] Home.tsxのリンクを有効化
- [ ] chrome-devtools-mcpで動作確認
- [ ] 追加された行が緑色で表示されることを確認
- [ ] 削除された行が赤色で表示されることを確認
- [ ] 変更なしの行が通常表示されることを確認
- [ ] レスポンシブ対応の確認
- [ ] コミット
